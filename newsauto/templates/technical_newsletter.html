<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ subject }}</title>
    <style>
        :root {
            --primary-color: #0066cc;
            --secondary-color: #00a86b;
            --bg-light: #f8f9fa;
            --bg-code: #282c34;
            --text-primary: #212529;
            --text-secondary: #6c757d;
            --border-color: #dee2e6;
            --success-color: #28a745;
            --warning-color: #ffc107;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: var(--text-primary);
            background: #ffffff;
        }

        .container {
            max-width: 680px;
            margin: 0 auto;
            background: white;
        }

        /* Header Section */
        .header {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            padding: 30px 20px;
            text-align: center;
        }

        .header h1 {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 8px;
            letter-spacing: -0.5px;
        }

        .header .tagline {
            font-size: 14px;
            opacity: 0.9;
            font-weight: 400;
        }

        /* Stats Bar */
        .stats-bar {
            background: var(--bg-light);
            padding: 15px 20px;
            display: flex;
            justify-content: space-around;
            border-bottom: 1px solid var(--border-color);
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 20px;
            font-weight: 700;
            color: var(--primary-color);
        }

        .stat-label {
            font-size: 12px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Content Sections */
        .content {
            padding: 30px 20px;
        }

        .section {
            margin-bottom: 40px;
        }

        .section-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--primary-color);
        }

        .section-icon {
            width: 24px;
            height: 24px;
            margin-right: 12px;
            background: var(--primary-color);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .section-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--text-primary);
            flex: 1;
        }

        .content-ratio {
            font-size: 12px;
            color: var(--text-secondary);
            background: var(--bg-light);
            padding: 2px 8px;
            border-radius: 12px;
        }

        /* Article Cards */
        .article-card {
            background: white;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 16px;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .article-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .article-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 12px;
        }

        .article-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
            text-decoration: none;
            line-height: 1.4;
        }

        .article-title:hover {
            color: var(--primary-color);
        }

        .article-badge {
            display: inline-block;
            padding: 4px 8px;
            background: var(--success-color);
            color: white;
            font-size: 11px;
            font-weight: 600;
            border-radius: 4px;
            text-transform: uppercase;
            margin-left: 8px;
            flex-shrink: 0;
        }

        .article-badge.curated {
            background: var(--warning-color);
            color: var(--text-primary);
        }

        .article-meta {
            display: flex;
            gap: 15px;
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 12px;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .article-summary {
            font-size: 15px;
            line-height: 1.7;
            color: var(--text-primary);
            margin-bottom: 16px;
        }

        /* Code Block Styling */
        .code-snippet {
            background: var(--bg-code);
            color: #abb2bf;
            padding: 12px;
            border-radius: 6px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 13px;
            overflow-x: auto;
            margin: 12px 0;
        }

        /* Key Insights Box */
        .key-insights {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .key-insights h3 {
            font-size: 16px;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .key-insights ul {
            list-style: none;
            padding: 0;
        }

        .key-insights li {
            padding: 8px 0;
            border-bottom: 1px solid rgba(255,255,255,0.2);
            font-size: 14px;
        }

        .key-insights li:last-child {
            border-bottom: none;
        }

        /* Visual Elements */
        .diagram-container {
            background: var(--bg-light);
            border-radius: 8px;
            padding: 20px;
            margin: 16px 0;
            text-align: center;
        }

        .diagram-title {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 12px;
        }

        /* CTA Buttons */
        .cta-button {
            display: inline-block;
            padding: 10px 20px;
            background: var(--primary-color);
            color: white;
            text-decoration: none;
            border-radius: 6px;
            font-weight: 600;
            font-size: 14px;
            transition: background 0.3s;
        }

        .cta-button:hover {
            background: #0052a3;
        }

        .cta-secondary {
            background: white;
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
        }

        .cta-secondary:hover {
            background: var(--bg-light);
        }

        /* Performance Metrics */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin: 16px 0;
        }

        .metric-card {
            background: var(--bg-light);
            padding: 12px;
            border-radius: 6px;
            text-align: center;
        }

        .metric-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary-color);
        }

        .metric-label {
            font-size: 12px;
            color: var(--text-secondary);
            margin-top: 4px;
        }

        /* Footer */
        .footer {
            background: var(--bg-light);
            padding: 30px 20px;
            text-align: center;
            border-top: 1px solid var(--border-color);
        }

        .social-links {
            margin: 20px 0;
        }

        .social-links a {
            display: inline-block;
            margin: 0 10px;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 20px;
        }

        .footer-links {
            margin: 20px 0;
            font-size: 14px;
        }

        .footer-links a {
            color: var(--text-secondary);
            text-decoration: none;
            margin: 0 10px;
        }

        .footer-links a:hover {
            color: var(--primary-color);
        }

        .company-info {
            font-size: 12px;
            color: var(--text-secondary);
            margin-top: 20px;
        }

        /* Mobile Responsive */
        @media (max-width: 600px) {
            .stats-bar {
                flex-direction: column;
                gap: 15px;
            }

            .metrics-grid {
                grid-template-columns: 1fr;
            }

            .article-header {
                flex-direction: column;
                gap: 8px;
            }

            .article-badge {
                margin-left: 0;
            }
        }

        /* Read Time Indicator */
        .read-time {
            display: inline-block;
            background: var(--bg-light);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            color: var(--text-secondary);
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>{{ newsletter.name }}</h1>
            <div class="tagline">{{ newsletter.tagline | default('Your weekly dose of technical excellence') }}</div>
        </div>

        <!-- Stats Bar -->
        <div class="stats-bar">
            <div class="stat-item">
                <div class="stat-value">{{ subscriber_count | default('10K+') }}</div>
                <div class="stat-label">Subscribers</div>
            </div>
            <div class="stat-item">
                <div class="stat-value">{{ open_rate | default('40%') }}</div>
                <div class="stat-label">Open Rate</div>
            </div>
            <div class="stat-item">
                <div class="stat-value">{{ read_time | default('5-7') }}</div>
                <div class="stat-label">Min Read</div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="content">
            <!-- Read Time Indicator -->
            <div style="text-align: center;">
                <span class="read-time">⏱️ Estimated read time: {{ read_time | default('5-7') }} minutes</span>
            </div>

            <!-- Key Insights Section -->
            {% if key_insights %}
            <div class="key-insights">
                <h3>🎯 This Week's Key Insights</h3>
                <ul>
                    {% for insight in key_insights %}
                    <li>{{ insight }}</li>
                    {% endfor %}
                </ul>
            </div>
            {% endif %}

            <!-- Original Content Section (65%) -->
            <div class="section">
                <div class="section-header">
                    <div class="section-icon">🚀</div>
                    <h2 class="section-title">Featured Analysis</h2>
                    <span class="content-ratio">65% Original</span>
                </div>

                {% for article in original_articles %}
                <div class="article-card">
                    <div class="article-header">
                        <a href="{{ article.url }}" class="article-title">{{ article.title }}</a>
                        <span class="article-badge">Original</span>
                    </div>

                    <div class="article-meta">
                        <span class="meta-item">📝 {{ article.author | default('Editorial Team') }}</span>
                        <span class="meta-item">📅 {{ article.published_at | dateformat }}</span>
                        <span class="meta-item">⏱️ {{ article.read_time | default('3 min') }}</span>
                    </div>

                    <div class="article-summary">
                        {{ article.summary }}
                    </div>

                    {% if article.code_snippet %}
                    <div class="code-snippet">{{ article.code_snippet }}</div>
                    {% endif %}

                    {% if article.metrics %}
                    <div class="metrics-grid">
                        {% for metric in article.metrics %}
                        <div class="metric-card">
                            <div class="metric-value">{{ metric.value }}</div>
                            <div class="metric-label">{{ metric.label }}</div>
                        </div>
                        {% endfor %}
                    </div>
                    {% endif %}

                    <a href="{{ article.url }}" class="cta-button">Read Full Analysis →</a>
                </div>
                {% endfor %}
            </div>

            <!-- Curated Content Section (25%) -->
            <div class="section">
                <div class="section-header">
                    <div class="section-icon">📚</div>
                    <h2 class="section-title">Curated Insights</h2>
                    <span class="content-ratio">25% Curated</span>
                </div>

                {% for article in curated_articles %}
                <div class="article-card">
                    <div class="article-header">
                        <a href="{{ article.url }}" class="article-title">{{ article.title }}</a>
                        <span class="article-badge curated">Curated</span>
                    </div>

                    <div class="article-meta">
                        <span class="meta-item">🔗 {{ article.source | default('External') }}</span>
                        <span class="meta-item">📅 {{ article.published_at | dateformat }}</span>
                    </div>

                    <div class="article-summary">
                        {{ article.summary }}
                    </div>

                    {% if article.key_takeaways %}
                    <div style="background: var(--bg-light); padding: 12px; border-radius: 6px; margin-top: 12px;">
                        <strong style="font-size: 14px;">Key Takeaways:</strong>
                        <ul style="margin: 8px 0; padding-left: 20px;">
                            {% for takeaway in article.key_takeaways %}
                            <li style="font-size: 14px; color: var(--text-secondary);">{{ takeaway }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                    {% endif %}
                </div>
                {% endfor %}
            </div>

            <!-- Syndicated Content Section (10%) -->
            {% if syndicated_articles %}
            <div class="section">
                <div class="section-header">
                    <div class="section-icon">🔄</div>
                    <h2 class="section-title">Industry News</h2>
                    <span class="content-ratio">10% Syndicated</span>
                </div>

                {% for article in syndicated_articles %}
                <div class="article-card">
                    <a href="{{ article.url }}" class="article-title">{{ article.title }}</a>
                    <div class="article-meta">
                        <span class="meta-item">🌐 {{ article.source }}</span>
                    </div>
                    <div class="article-summary">{{ article.summary | truncate(150) }}</div>
                </div>
                {% endfor %}
            </div>
            {% endif %}

            <!-- Call to Action -->
            {% if premium_cta %}
            <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; border-radius: 8px; text-align: center; margin: 30px 0;">
                <h2 style="margin-bottom: 10px;">🚀 Upgrade to Premium</h2>
                <p style="margin-bottom: 20px; opacity: 0.9;">Get exclusive deep-dives, source code, and direct access to our expert community.</p>
                <a href="{{ premium_url }}" class="cta-button" style="background: white; color: #667eea;">Start 7-Day Free Trial</a>
            </div>
            {% endif %}
        </div>

        <!-- Footer -->
        <div class="footer">
            <div class="social-links">
                <a href="{{ twitter_url }}">🐦</a>
                <a href="{{ linkedin_url }}">💼</a>
                <a href="{{ github_url }}">💻</a>
            </div>

            <div class="footer-links">
                <a href="{{ unsubscribe_url }}">Unsubscribe</a>
                <a href="{{ preferences_url }}">Update Preferences</a>
                <a href="{{ archive_url }}">Newsletter Archive</a>
                <a href="{{ refer_url }}">Refer a Friend</a>
            </div>

            <div class="company-info">
                <p>© {{ current_year }} {{ company_name | default('Newsauto') }}. All rights reserved.</p>
                <p style="margin-top: 8px; font-size: 11px;">
                    {{ subscriber_address | default('You are receiving this because you subscribed to our newsletter.') }}
                </p>
                {% if tracking_pixel %}
                <img src="{{ tracking_pixel }}" alt="" width="1" height="1" style="display: block;">
                {% endif %}
            </div>
        </div>
    </div>
</body>
</html>